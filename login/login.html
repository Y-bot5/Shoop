<!DOCTYPE html>
<html lang="en" data-theme="light dark">
<head>
  <meta charset="utf-8">
    <title>Login | Shoop</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">

      <link rel="stylesheet" href="/Shoop/login/styles.css">

        <!-- Favicons -->
          <link rel="icon" href="/Shoop/icon-32.png" sizes="32x32">
            <link rel="icon" href="/Shoop/icon-192.png" sizes="192x192">

            </head>
            <body>

            <h1>Login</h1>

            <form id="loginForm">
              <input id="emailInput" type="email" placeholder="Email" autofill="email" required>
                <input id="passwordInput" type="password" placeholder="Password" autofill="current-password" required>
                  <button type="submit">Login / Sign up</button>
                  </form>

                  <script type="module">
import {
  auth,
  signInWithEmailAndPassword,
  createUserWithEmailAndPassword,
  updateProfile
} from "/Shoop/firebase.js";

loginForm.onsubmit = async (e) => {
  e.preventDefault();

  const email = emailInput.value.trim();
  const password = passwordInput.value;

  try {
    await signInWithEmailAndPassword(auth, email, password);

  } catch (err) {
    // User doesn't exist → create account
    if (err.code === "auth/user-not-found" || err.code === "auth/invalid-credential") {
      const cred = await createUserWithEmailAndPassword(auth, email, password);

      // STEP 2A — set display name
      await updateProfile(cred.user, {
        displayName: email.split("@")[0],
        photoURL: "/Shoop/noProfile.webp"
      });

    } else {
      alert(err.message);
      return;
    }
  }

  location.replace("/Shoop/index.html");
};
</script>
                                                                                              </body>
                                                                                              </html>