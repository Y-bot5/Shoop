<!DOCTYPE html>
<html lang="en" data-theme="light dark">
<head>
<meta charset="utf-8">

<title>Profile | Shoop</title>

    <link rel="icon" href="/Shoop/icon-32.png" sizes="32x32">
            <link rel="icon" href="/Shoop/icon-192.png" sizes="192x192">

    <link rel="manifest" href="/shoop/manifest.json">

    <link rel="stylesheet" href="/shoop/profile/styles.css">
        <link rel="stylesheet" href="/Shoop/styles.css">

<meta name="viewport" content="width=device-width, initial-scale=1">

<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/Shoop/sw.js')
      .then(() => console.log("Service Worker Registered for Shoop"));
  }
    </script>
    <script type="module" src="/Shoop/profile.js"></script>
</head>
            <body>
                <header class="topbar">
  <button id="menuBtn" aria-label="Menu">â˜°</button>

  <a id="profileLink">
    <img
      id="profileIcon"
      src="/Shoop/noProfile.webp"
      alt="Profile"
    >
  </a>
</header>

                          <h1 id="status">Loadingâ€¦</h1>

                                      <p>Name: <span id="name"></span></p>
                                                  <p>Email: <span id="email"></span></p>

                                                              <div id="profileMenu">
  <button id="editBtn">Edit profile</button>
  <button id="logoutBtn">Log out</button>
</div>

<script type="module">
import {
  auth,
  onAuthStateChanged,
  signOut
} from "/Shoop/firebase.js";

/* --- Get URL username --- */
const params = new URLSearchParams(window.location.search);
const viewedUsername = params.get("u");

/* --- Elements --- */
const avatar = document.getElementById("avatar");
const nameEl = document.getElementById("name");
const emailEl = document.getElementById("email");

const editBtn = document.getElementById("editBtn");
const logoutBtn = document.getElementById("logoutBtn");

/* --- Auth state --- */
onAuthStateChanged(auth, user => {
  if (!user) {
    // Not logged in
    location.replace("/Shoop/login.html");
    return;
  }

  const myUsername = user.displayName;

  // No ?u= â†’ redirect to own profile
  if (!viewedUsername) {
    location.replace(
      `/Shoop/profile/?u=${encodeURIComponent(myUsername)}`
    );
    return;
  }

  // Fill profile info (Auth-only = your own data)
  avatar.src = user.photoURL || "/Shoop/noProfile.webp";
  nameEl.textContent = viewedUsername;
  emailEl.textContent =
    viewedUsername === myUsername ? user.email : "";
  statusEl.textContent = "Profile";

  // Own profile â†’ show controls
  if (viewedUsername === myUsername) {
    editBtn.style.display = "inline-block";
    logoutBtn.style.display = "inline-block";
  }
  // Someone else â†’ view only
  else {
    editBtn.style.display = "none";
    logoutBtn.style.display = "none";
  }

  // Page title
  document.title =
    viewedUsername === myUsername
      ? "Your Profile | Shoop"
      : `${viewedUsername} | Shoop`;
});

/* --- Logout --- */
logoutBtn?.addEventListener("click", async () => {
  await signOut(auth);
  location.replace("/Shoop/login.html");
});
</script>

              <script>
menuBtn.onclick = () => {
  alert("Menu coming soon ðŸ‘€");
};
</script>
                                                                                                                                                                                                                                                                                                                                                                                                  </body>
                                                                                                                                                                                                                                                                                                                                                                                                  </html>